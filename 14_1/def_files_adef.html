<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Legato: Legato adef Files</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

<link rel="icon" type="image/png" href="favicon.ico">
</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo">
    <img alt="Logo" src="legatoLogo.png"/>
    <div id="projectbrief">Wireless M2M smooth and connected</div>
  </td>
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('def_files_adef.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Legato adef Files </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="def_files_adef.html#sandboxed">sandboxed</a> <br/>
 <a class="el" href="def_files_adef.html#start">start</a> <br/>
 <a class="el" href="def_files_adef.html#numProcs">numProcs</a> <br/>
 <a class="el" href="def_files_adef.html#mqueueSize">mqueueSize</a> <br/>
 <a class="el" href="def_files_adef.html#rtSignalQueueSize">rtSignalQueueSize</a> <br/>
 <a class="el" href="def_files_adef.html#fileSystemSize">fileSystemSize</a> <br/>
 <a class="el" href="def_files_adef.html#filesAdef">files</a> <br/>
 <a class="el" href="def_files_adef.html#executablesAdef">executables</a> <br/>
 <a class="el" href="def_files_adef.html#importAdef">import</a> <br/>
 <a class="el" href="def_files_adef.html#groupsAdef">groups</a> <br/>
 <a class="el" href="def_files_adef.html#refprocessesAdef">processes</a></p>
<p>Legato uses these sections in the .adef:</p>
<h2><a class="anchor" id="sandboxed"></a>
sandboxed</h2>
<p>Specifies if the app will be launched inside a sandbox.</p>
<p>Permitted content in this section is:</p>
<ul>
<li><b>true</b> - app will be run inside of a sandbox.</li>
<li><b>false</b> - app won't be run in a sandbox.</li>
</ul>
<p>The default is <b>true</b>.</p>
<p>If an app is not inside of a sandbox (unsandboxed), it can see the target device's real root file system. A sandboxed app can't see the target's real root file system; instead, a sandboxed app has its own, separate root file system (which it can't leave).</p>
<p>Each app has its own user ID and primary group ID. User name and primary group name is "app-xxxx", where the "xxxx" is replaced with the name of the app.</p>
<p>Sandboxed apps aren't allowed to be members of other groups and are not allowed to have any capabilities (see "man 7 capabilities") set on their executables.</p>
<p>Unsandboxed apps are allowed to have executables with capabilities and be members of other groups (see the "groups:" section).</p>
<p>While a user and/or group will be automatically created if missing for the specified app, only users and groups of sandboxed app will be automatically deleted when those apps are uninstalled.</p>
<div class="fragment"><pre class="fragment">sandboxed: <span class="keyword">false</span>
</pre></div><h2><a class="anchor" id="start"></a>
start</h2>
<p>Specifies if the app should start automatically at start-up: "auto" sets the app to start automatically by the Supervisor. "manual" sets the app to start through a manual prompt to the Supervisor.</p>
<div class="fragment"><pre class="fragment">start: <span class="keyword">auto</span>
</pre></div><h2><a class="anchor" id="numProcs"></a>
numProcs</h2>
<p>Specifies the maximum number of processes allowed to run at one time: an integer number of processes.</p>
<div class="fragment"><pre class="fragment">numProcs: 4
</pre></div><h2><a class="anchor" id="mqueueSize"></a>
mqueueSize</h2>
<p>Specifies the maximum number of POSIX MQueues messages permitted.</p>
<div class="fragment"><pre class="fragment">mqueueSize: 22
</pre></div><h2><a class="anchor" id="rtSignalQueueSize"></a>
rtSignalQueueSize</h2>
<p>Specifies the maximum number of real-time signals that can be queued (waiting for delivery to processes).</p>
<div class="fragment"><pre class="fragment">rtSignalQueueSize: 10
</pre></div><h2><a class="anchor" id="fileSystemSize"></a>
fileSystemSize</h2>
<p>Specifies the maximum amount of RAM that can be consumed by an app's temp (volatile) file system at runtime.</p>
<div class="fragment"><pre class="fragment">fileSystemSize: 120K
</pre></div><h2><a class="anchor" id="filesAdef"></a>
files</h2>
<p>Lists additional files to be included in an app so they’re available at runtime (e.g., audio files, web pages, executable scripts or programs from external build system).</p>
<p>Three things need to be specified for each app:</p>
<p><b>Access permissions</b> - any combination of one or more of the following letters, enclosed in square brackets:</p>
<ul>
<li>r = readable</li>
<li>w = writeable but changes will be discarded on reset</li>
<li>p = writeable and changes to it will be persistent (i.e., survive power failure or reset)</li>
<li>x = executable</li>
</ul>
<p>If permissions values are not specified, then read-only ([r]) is the default.</p>
<p><b>Build system path</b> - file system path on the build PC where the file is located at build time.</p>
<p><b>Target path</b> - file system path inside the app sandbox on the target where the file will appear at runtime. Unsandboxed apps' path will be prefixed with "/opt/legato/apps/xxxx", where "xxxx" is replaced by the app name.</p>
<p>File paths can be enclosed in quotation marks (either single ' or double "). This is required when the file path contains spaces.</p>
<div class="fragment"><pre class="fragment">files:

    [r]     audio/alert.wav     /usr/share/sounds/
    [rx]  third-party/foobar/bin/foobar   /bin/
    htdocs/index.html   /var/www/
    <span class="stringliteral">&quot;stuff/file name with spaces&quot;</span>  /usr/share/stuff/
    <span class="stringliteral">&#39;stuff/another file&#39;</span>   /usr/share/stuff/
</pre></div><p><b>Permissions</b></p>
<p>File permissions and ownership in the original file on the development PC file system are copied into the application for both users and groups.</p>
<p>When the application is installed on a target: <br/>
</p>
<ul>
<li>the owner and group are set to <code>root</code>.</li>
<li>the executable permission is removed from all files outside of the application's bin directory.</li>
<li>executable permission is granted to all directories.</li>
<li>executable permission is granted to all files inside the application's bin directory.</li>
<li>write permission is removed from everything in the application.</li>
<li>the <code>setuid</code> bit is cleared on everything in the application.</li>
</ul>
<h2><a class="anchor" id="executablesAdef"></a>
executables</h2>
<p>Lists executables to be constructed and moved to the “bin” directory inside the app.</p>
<p>An executable’s content is specified inside parentheses following the name:</p>
<ul>
<li>relative file system path to source code file (e.g., a .c, .java, or .lua file)</li>
<li>component</li>
<li>relative file system path to library file (e.g., .a or .so file).</li>
</ul>
<p>Only .c files, components, and libraries are currently supported.</p>
<div class="fragment"><pre class="fragment">executables:

    myexe1 ( file1.c libgoodstuff.so )
    myexe2 ( foobar toto )
</pre></div><h2><a class="anchor" id="importAdef"></a>
import</h2>
<p>If components are in an executable, they’ll be built and linked into the executable with its COMPONENT_INIT function run at process start-up. The component’s runtime files are packaged inside the app to be installed on the target. If a source file is in an executable, the build tools search for it according to the source search path. It’s then compiled (if written in a compiled language) and linked into the executable.</p>
<p>All source files specified for an executable are considered a component (called "default"); one of those source files must implement a COMPONENT_INIT function called at start-up. If a library is an executable, the build tools search for it in the .adef and Component.cdef files. When the executable is linked, it includes libraries in the order listed. It’s permitted to list the same library more than once; sometimes you have unresolved symbol because of the single-pass linker.</p>
<p>C files will be compiled and linked using the appropriate compiler tool chain, depending on the built target device.</p>
<p>Sometimes, incompatibilities between components or source code prevent them from being included in the same executable (e.g., Java sources and C). The build tools will check and advise if that’s the case.</p>
<p>The <b>import</b> section lists things imported to the app’s sandbox at runtime from outside of the sandbox. The contents appear similar to the files: section’s content, but meanings are different: Things listed in the “import” section are expected to be found on the target at runtime. They are not copied into the app at build time; they're made accessible to the app inside of its sandbox at runtime.</p>
<p>Currently, only virtual file system objects (files, directories, named sockets and pipes, device files, etc.) are explicitly imported. (Note: IPC interfaces are imported by components using the Component.cdef file’s “import” section.)</p>
<p>This section is ignored if the app is not sandboxed (if sandboxed set to false).</p>
<p>Items in the import section have essentially the same format as items in the files section, except the first path must be an absolute path (beginning with ‘/’).</p>
<p>The first path is the object to be imported that is an absolute path in the target device’s file system, outside of the sandbox.</p>
<p>The second path is the absolute file system path inside the app’s sandbox where the object will appear at runtime.</p>
<p>File paths can be enclosed in quotation marks (either single ' or double "). This is required when the file path contains spaces.</p>
<div class="fragment"><pre class="fragment"><span class="keyword">import</span>:
    <span class="comment">// I get character stream input from outside via a named pipe (read-only)</span>
    /var/run/someNamedPipe  /var/run/

    <span class="comment">// I need read and write access to UART2.</span>
    [rw] /dev/ttyS1  /dev/

    <span class="comment">// I need to be able to play back audio files installed in /usr/local/share/audio.</span>
    <span class="stringliteral">&quot;/usr/local/share/audio/error message.wav&quot;</span> /usr/share/audio/
    <span class="stringliteral">&#39;/usr/local/share/audio/success message.wav&#39;</span> /usr/share/audio/
</pre></div><p>Permissions settings in import can't override permissions on the object in the target’s file system. If an object is read-only for the app’s user account in the root file system, it'll still be read-only accessible inside the app’s sandbox (even if imported “[rw]” in the app’s .adef file).</p>
<p>File permissions and ownership (group and user) on the original file in the target system remain in effect inside the sandbox.</p>
<h2><a class="anchor" id="groupsAdef"></a>
groups</h2>
<p>Add an unsandboxed app's user to groups on the target system. Not permitted for sandboxed apps.</p>
<div class="fragment"><pre class="fragment">groups:
    www-data
    modem
</pre></div><h2><a class="anchor" id="refprocessesAdef"></a>
processes</h2>
<p>The processes section of the .adef also has sub-sections <a class="el" href="processes_adef.html">adef processes</a> .</p>
<hr/>
<p>Copyright (C) Sierra Wireless, Inc. 2014. All rights reserved. Use of this work is subject to license. </p>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div>
  <div id="nav-path" class="navpath">
    <ul>
   <div class="footer">
        <div>
            <a href="http://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless 2014
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.7.6.1
        </div>
    </div>
</body>
</html>
