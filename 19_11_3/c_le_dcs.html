<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html data-context="Build Apps" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>le_dcs Interface  - Legato Docs</title>
<meta content="legato™ is an open source Linux-based embedded platform designed to simplify connected IoT application development" name="description"/>
<meta content="legato, iot" name="keywords"/>
<meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="19.11.3" name="legato-version"/>
<link href="resources/images/legato.ico" rel="shortcut icon"/>
<link href="resources/images/legato.ico" rel="icon" type="image/x-icon"/>
<link href="resources/images/legato.ico" rel="shortcut icon" type="image/x-icon"/>
<link href="resources/images/legato.ico" rel="apple-touch-icon" type="image/x-icon"/>
<link href="resources/css/style.css" media="screen" rel="stylesheet" type="text/css"/>
<link href="resources/css/font-awesome.css" rel="stylesheet" type="text/css"/>
<!--[if IE]>
        <script src="resources/js/html5shiv.js"></script>
        <script src="resources/js/respond.js"></script>
        <![endif]-->
<script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
<script src="resources/js/main.js"></script>
<script src="tocs/Build_Apps_Experimental_Features.json"></script>
</head>
<body>
<noscript>
<input class="modal-closing-trick" id="modal-closing-trick" type="checkbox"/>
<div id="nojs">
<label for="modal-closing-trick">
<span>You seem to not have Javascript <a href="http://enable-javascript.com">enabled</a>, so site functionality like the search and navigation tree won't work.</span>
</label>
</div>
</noscript>
<div class="wrapper">
<div class="fa fa-bars documentation" id="menu-trigger"></div>
<div id="top">
<header>
<nav>
<a class="navlink" href="/">Introduction</a><a class="navlink selected" href="buildAppsMain.html">Build Apps</a><a class="navlink" href="buildPlatformMain.html">Build Platform</a><a class="navlink" href="aboutMain.html">About</a>
</nav>
</header>
</div>
<div class="white" id="menudocumentation">
<header>
<a href="/"> <img alt="Back to Legato Homepage" id="logo" src="resources/images/legato_logo.png"/></a>
<h2>/ Build Apps</h2>
<nav class="secondary">
<a href="getStarted.html">Get Started</a><a href="concepts.html">Concepts</a><a href="apiGuidesMain.html">API Guides</a><a href="tools.html">Tools</a><a href="howToMain.html">How To</a><a class="link-selected" href="experimentalMain.html">Experimental Features</a>
</nav>
<nav class="ui-front">
<i class="fa fa-search" id="search-icon"></i>
<input id="searchbox" placeholder="Search"/>
</nav>
</header>
</div>
<div id="resizable">
<div id="left">
<div id="tree1"></div>
</div>
</div>
<div class="content">
<div class="header">
<div class="headertitle">
<h1 class="title">le_dcs Interface </h1> </div>
</div><div class="contents">
<div class="textblock"><p><a class="el" href="le__dcs__interface_8h.html">API Reference</a> <br/>
</p>
<p>When applications need to exchange data with other devices on the packet switched data network, a data channel needs to be first established. After such channel is successfully established, then applications can open up IP sockets on this data channel as necessary as a data pipe for sending and receiving data.</p>
<h1><a class="anchor" id="le_dcs_ChannelOps"></a>
Channel Operations</h1>
<p>The Data Channel Service (DCS) provides an API interface for a client application to learn about all the data channels available on a device, and administratively start or stop a selected channel. Data channels that are managed by DCS can be shared by multiple applications.</p>
<dl class="section note"><dt>Note</dt><dd>In the context of this documentation the acronym DCS refers to the <code>le_dcs</code> interface, unless specified otherwise.</dd></dl>
<p>When one application asks DCS to start a specified channel, DCS associates it with this channel; similarly when it asks DCS to stop this channel, DCS disassociates it from its use. Therefore, in this way what a client application sees and gets as a channel's state is its administrative state, not its operational state. A channel is operationally brought up when its administratively state goes up to indicate that it is needed by at least one application. Similarly, it is operationally brought down when its administrative state goes down to indicate that it is needed by no application anymore. Thus, it is possible for a chanel to be administratively up, meaning that it is associated with some applications, but operationally down due to certain reasons, including network errors, weak signal, temporary downtime, etc.</p>
<h1><a class="anchor" id="le_dcs_ChannelReferenceUniqueID"></a>
Channel Reference</h1>
<p>Since DCS provides channel choices, a channel's object reference is used in most of its APIs as the input identifier to uniquely identify the channel of choice. This channel reference is unique across the device over all supported technologies, and is managed and provided by DCS.</p>
<p>Before a channel can be specified as an input argument of choice, an application needs to call <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a> to get the list of all channels and from those results learn about each one's channel reference for use in any other <code>le_dcs</code> and le_net API calls.</p>
<h1><a class="anchor" id="le_dcs_RelateToLeNet"></a>
le_net Interface</h1>
<p>Associated with the <code>le_dcs</code> interface, the <code>le_net</code> interface provides network services to DCS-managed channels. <code>le_net</code> provides APIs for setting the device's default gateway addresses, DNS server addresses, adding routes, etc.</p>
<h1><a class="anchor" id="le_dcs_TechConfigs"></a>
Technical Configurations</h1>
<p>With the use of le_data, there used to be technology-specific configurations saved in Legato's configuration tree under DCS's paths. <code>le_dcs</code> expanded DCS's capabilities to modularize technology-specific implementations and support multiple active channels over different technologies simultaneously, <code>le_dcs</code> no longer keeps technology-specific configurations under its tree paths.</p>
<p>For WiFi-specific configurations, the <code>le_dcs</code> interface no longer saves them on its common path dataConnectionService:/wifi/SSID. Per-SSID configurations are saved now on the wifiService path under the SSID name itself, e.g. wifiService:/wifi/channel/MY-MOBILE/setProtocol and wifiService:/wifi/channel/MY-WLAN/hidden where MY-MOBILE and MY-WLAN are both SSIDs. Moreover, confidential user credentials, like passphrase, PSK, user name with password, are now kept in secure storage. In the case of WiFi, these are kept and managed there by the wifiClient, only through which reading and writing of such info can be done. Note that the WiFi security protocol used for each SSID remains on the config tree mentioned above for easy reference and debugging. In this way, <code>le_dcs</code> keeps technology-specific configurations on the path of the technology itself.</p>
<p>Example of WiFi Config: </p><pre class="fragment"> wifiService:/
   wifi/
     channel/
       MY-MOBILE/
         secProtocol&lt;string&gt; == 3
       MY-WLAN/
         secProtocol&lt;string&gt; == 3
         hidden&lt;bool&gt; == true
</pre><p>The above illustration shows that under this new path structure multiple configurations for multiple channels can be stored and easily expanded for future needs. For more details about WiFi configurations, please refer to <a class="el" href="le__wifiClient__interface_8h.html">le_wifiClient_interface.h</a>.</p>
<p>For cellular-specific configurations, each time a cellular channel needs to be specified as an input argument in calling a <code>le_dcs</code> API.<code>le_dcs</code> does not use nor refer to the default cellular profile index saved under the path dataConnectionService:/cellular/profileIndex.</p>
<h1><a class="anchor" id="le_dcs_APIOverview"></a>
API Overview</h1>
<p>The <code>le_dcs</code> APIs provide applications the interfaces to:</p>
<table class="doxtable">
<tr>
<th>Function </th><th>Description  </th></tr>
<tr>
<td><a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a> </td><td>Retrieves the list of all available channels across all supported technologies </td></tr>
<tr>
<td><a class="el" href="le__dcs__interface_8h.html#a4dd014cbb4e31cab52bc31521ae3af33">le_dcs_GetTechnology()</a> </td><td>Queries for a channel reference's technology type </td></tr>
<tr>
<td><a class="el" href="le__dcs__interface_8h.html#a7bd57335fd03f2b434e45b807950f1d0">le_dcs_GetReference()</a> </td><td>Queries for a channel's reference by its name and technology </td></tr>
<tr>
<td><a class="el" href="le__dcs__interface_8h.html#a63f09351605da41e073addc2167869b1">le_dcs_GetState()</a> </td><td>Queries for a channel's administrative state and network interface name by its reference </td></tr>
<tr>
<td><a class="el" href="le__dcs__interface_8h.html#ac4b6e94757a1db7d636d2f2fd9440856">le_dcs_AddEventHandler()</a> </td><td>Adds a channel event notification handler for a specific channel </td></tr>
<tr>
<td><a class="el" href="le__dcs__interface_8h.html#aa9d64c593465795616cd5306b4965175">le_dcs_RemoveEventHandler()</a> </td><td>Removes a channel event notification handler for a specific channel </td></tr>
<tr>
<td><a class="el" href="le__dcs__interface_8h.html#a5bc8d9cf7b8e79645ab89845d8c3b05a">le_dcs_Start()</a> </td><td>Starts a channel </td></tr>
<tr>
<td><a class="el" href="le__dcs__interface_8h.html#abb80712dce43754bdb70e76faf788d61">le_dcs_Stop()</a> </td><td>Stops a channel </td></tr>
</table>
<h2><a class="anchor" id="le_dcs_APIDetails_GetChannels"></a>
Get Channel</h2>
<p>For an application that seeks to use the <code>le_dcs</code> APIs, the first step is to call <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a> to obtain an up-to-date list of all channels available over all supported technologies on which are the channel reference and technology type of each available channel. The channel that the app wishes to communicate with can then be chosen from this list.</p>
<dl class="section note"><dt>Note</dt><dd>To call <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a> the application needs to provide a handler function to handle the results to be returned, and wait until such results come back before calling subsequent <code>le_dcs</code> APIs. <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a> is asynchronous, due to need of some technologies to actively re-scan for their latest lists of available channels, i.e., WiFi.</dd>
<dd>
Moreover, on the returned channel list the channel state of each channel is provided. However, it is a dynamic parameter which value might keep changing and is, thus, included as a result only for reference. Client apps need to know that it was a value retrieved at the moment when DCS performed the channel query, but may not necessarily stay the same when they get it as part of the channel list results.</dd></dl>
<p>Example of <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a>: </p><pre class="fragment"><div class="line"><span class="comment">// This is the callback function for handling the results of a channel list query</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> ClientChannelQueryHandler</div><div class="line">(</div><div class="line">    <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> result,                       <span class="comment">///&lt; [IN] Result of the query</span></div><div class="line"><span class="comment"></span>    <span class="keyword">const</span> le_dcs_ChannelInfo_t *channelList,  <span class="comment">///&lt; [IN] Channel list returned</span></div><div class="line"><span class="comment"></span>    <span class="keywordtype">size_t</span> channelListSize,                   <span class="comment">///&lt; [IN] Channel list's size</span></div><div class="line"><span class="comment"></span>    <span class="keywordtype">void</span> *contextPtr                          <span class="comment">///&lt; [IN] Associated user context pointer</span></div><div class="line"><span class="comment"></span>)</div><div class="line">{</div><div class="line">    uint16_t i;</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Received channel query result %d, channel list size %d"</span>, result, channelListSize);</div><div class="line"> </div><div class="line">    <span class="keywordflow">if</span> (channelListSize == 0)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; channelListSize; i++)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Available channel #%d: name %s from technology %d, state %d, reference %p"</span>,</div><div class="line">                i + 1, channelList[i].name, channelList[i].technology, channelList[i].state,</div><div class="line">                channelList[i].ref);</div><div class="line">    }</div><div class="line">}</div><div class="line"> </div><div class="line"><span class="comment">// This is the function initiating a channel list query</span></div><div class="line"><span class="keywordtype">void</span> ClientGetChannels</div><div class="line">(</div><div class="line">    <span class="keywordtype">void</span></div><div class="line">)</div><div class="line">{</div><div class="line">    <a class="code" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels</a>(ClientChannelQueryHandler, NULL);</div><div class="line">}</div></pre><!-- fragment --><h2><a class="anchor" id="le_dcs_APIDetails_GetReference"></a>
Get Channel Reference</h2>
<p>If an application wants to user <code>le_dcs</code> over a channel that is already known and won't come and go frequently, i.e., a cellular channel, then the app can learn about its channel reference via either <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a> or <a class="el" href="le__dcs__interface_8h.html#a7bd57335fd03f2b434e45b807950f1d0">le_dcs_GetReference()</a>. <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a> provides better reliability, <a class="el" href="le__dcs__interface_8h.html#a7bd57335fd03f2b434e45b807950f1d0">le_dcs_GetReference()</a> is a synchronous transaction that provides the technology and channel type faster but without the reliability of <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a>.</p>
<p>Example of <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a> used to retrieve a specific channel's channel reference: </p><pre class="fragment"><div class="line"><span class="keywordtype">void</span> ClientGetReference</div><div class="line">(</div><div class="line">    <span class="keywordtype">char</span> channelName[LE_DCS_CHANNEL_NAME_MAX_LEN],</div><div class="line">    le_dcs_Technology_t channelTech</div><div class="line">)</div><div class="line">{</div><div class="line">    le_dcs_ChannelRef_t ref = <a class="code" href="le__dcs__interface_8h.html#a7bd57335fd03f2b434e45b807950f1d0">le_dcs_GetReference</a>(channelName, channelTech);</div><div class="line">    <span class="keywordflow">if</span> (ref == 0)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a353590f91b3143a7ba3a416ae5a50c3d">LE_ERROR</a>(<span class="stringliteral">"Failed to retrieve channel reference for channel %s of tech %d"</span>,</div><div class="line">                 channelName, channelTech);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Retrieved channel reference %p for channel %s of tech %d"</span>, channelName,</div><div class="line">            channelTech, ref);</div><div class="line">}</div></pre><!-- fragment --><h2><a class="anchor" id="le_dcs_APIDetails_GetTechnology"></a>
Channel Technology</h2>
<p>DCS provides <a class="el" href="le__dcs__interface_8h.html#a4dd014cbb4e31cab52bc31521ae3af33">le_dcs_GetTechnology()</a> to applications for querying for the technology type of a known channel reference. This should be used when those applications are seeking to remember all channel references returned via <a class="el" href="le__dcs__interface_8h.html#adf20879f6e0d9e08b9cd02a6996db054">le_dcs_GetChannels()</a> but not all the details about each channel.</p>
<p>Example over how to use <a class="el" href="le__dcs__interface_8h.html#a4dd014cbb4e31cab52bc31521ae3af33">le_dcs_GetTechnology()</a>: </p><pre class="fragment"><div class="line"><span class="keywordtype">void</span> ClientGetTechnology</div><div class="line">(</div><div class="line">    le_dcs_ChannelRef_t channelRef</div><div class="line">)</div><div class="line">{</div><div class="line">    le_dcs_Technology_t channelTech = <a class="code" href="le__dcs__interface_8h.html#a4dd014cbb4e31cab52bc31521ae3af33">le_dcs_GetTechnology</a>(channelRef);</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Retrieved tech type %d for channel reference %p "</span>, channelTech, channelRef);</div><div class="line">}</div></pre><!-- fragment --><h2><a class="anchor" id="le_dcs_APIDetails_GetState"></a>
Channel State</h2>
<p>As a channel's administrative state might change over time, <a class="el" href="le__dcs__interface_8h.html#a63f09351605da41e073addc2167869b1">le_dcs_GetState()</a> queries for a given channel's up-to-date state.</p>
<p>Example of checking for State: </p><pre class="fragment"><div class="line"><span class="keywordtype">void</span> ClientGetAdminState</div><div class="line">(</div><div class="line">    le_dcs_ChannelRef_t channelRef</div><div class="line">)</div><div class="line">{</div><div class="line">    le_dcs_State_t state;</div><div class="line">    <span class="keywordtype">char</span> interfaceName[LE_DCS_INTERFACE_NAME_MAX_LEN+1];</div><div class="line">    <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> ret;</div><div class="line"> </div><div class="line">    ret = <a class="code" href="le__dcs__interface_8h.html#a63f09351605da41e073addc2167869b1">le_dcs_GetState</a>(channelRef, &amp;state, interfaceName, LE_DCS_INTERFACE_NAME_MAX_LEN);</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> != ret)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a353590f91b3143a7ba3a416ae5a50c3d">LE_ERROR</a>(<span class="stringliteral">"Failed to get admin state of channel reference %p; return code %d"</span>,</div><div class="line">                 channelRef, ret);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Retrieved for channel reference %s network interface %s, admin state %s"</span>,</div><div class="line">            channelRef, interfaceName, (state==LE_DCS_STATE_UP) ? <span class="stringliteral">"up"</span> : <span class="stringliteral">"down"</span>);</div><div class="line">}</div></pre><!-- fragment --><h2><a class="anchor" id="le_dcsAPIDetails_EventHandler"></a>
Channel Event Handler</h2>
<p>Applications that want to be kept posted about any state changes of the channel can fulfill this need by providing DCS a channel event handler via <a class="el" href="le__dcs__interface_8h.html#ac4b6e94757a1db7d636d2f2fd9440856">le_dcs_AddEventHandler()</a> per channel. For each channel managed by le_dcs, there could be a chain of event handlers provided by multiple applications interested in it. After an application is disassociated from a channel or uninterested in it, it can call <a class="el" href="le__dcs__interface_8h.html#aa9d64c593465795616cd5306b4965175">le_dcs_RemoveEventHandler()</a> to remove its event handler.</p>
<p>Example of checking for state within an event handler: </p><pre class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> clientEventHandler</div><div class="line">(</div><div class="line">    le_dcs_ChannelRef_t channelRef, <span class="comment">///&lt; [IN] The channel for which the event is</span></div><div class="line"><span class="comment"></span>    le_dcs_Event_t event,           <span class="comment">///&lt; [IN] Event up, down or temp-down</span></div><div class="line"><span class="comment"></span>    int32_t code,                   <span class="comment">///&lt; [IN] Additional event code, like error code</span></div><div class="line"><span class="comment"></span>    <span class="keywordtype">void</span> *contextPtr                <span class="comment">///&lt; [IN] Associated user context pointer</span></div><div class="line"><span class="comment"></span>)</div><div class="line">{</div><div class="line">    <span class="keywordtype">char</span> *eventString;</div><div class="line">    <span class="keywordflow">switch</span> (event)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">case</span> LE_DCS_EVENT_UP:</div><div class="line">            eventString = <span class="stringliteral">"Up"</span>;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> LE_DCS_EVENT_DOWN:</div><div class="line">            eventString = <span class="stringliteral">"Down"</span>;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> LE_DCS_EVENT_TEMP_DOWN:</div><div class="line">            eventString = <span class="stringliteral">"Temporary Down"</span>;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">            eventString = <span class="stringliteral">"Unknown"</span>;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Received for channel reference %p event %s"</span>, channelRef,</div><div class="line">            eventString, channelDb-&gt;channelName, appSessionRef);</div><div class="line">}</div><div class="line"> </div><div class="line"><span class="keywordtype">void</span> ClientAddEventHandler</div><div class="line">(</div><div class="line">    le_dcs_ChannelRef_t channelRef,</div><div class="line">    le_dcs_EventHandlerRef_t *eventHandlerRef</div><div class="line">)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> ((channelRef == 0) || !eventHandlerRef)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a353590f91b3143a7ba3a416ae5a50c3d">LE_ERROR</a>(<span class="stringliteral">"Invalid inputs for adding event handler for channel reference %p"</span>,</div><div class="line">                 channelRef);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    *eventHandlerRef = <a class="code" href="le__dcs__interface_8h.html#ac4b6e94757a1db7d636d2f2fd9440856">le_dcs_AddEventHandler</a>(channelRef, clientEventHandler, NULL);</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Added event handler for channel reference %p; event handler reference %p"</span>,</div><div class="line">            channelRef, *eventHandlerRef);</div><div class="line">}</div><div class="line"> </div><div class="line"><span class="keywordtype">void</span> ClientRemoveEventHandler</div><div class="line">(</div><div class="line">    le_dcs_EventHandlerRef_t eventHandlerRef</div><div class="line">)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (!eventHandlerRef)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a353590f91b3143a7ba3a416ae5a50c3d">LE_ERROR</a>(<span class="stringliteral">"Got null channel event handler to remove"</span>);</div><div class="line">        <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    <a class="code" href="le__dcs__interface_8h.html#aa9d64c593465795616cd5306b4965175">le_dcs_RemoveEventHandler</a>(eventHandlerRef);</div><div class="line">}</div></pre><!-- fragment --><h3><a class="anchor" id="le_dcsAPIDetails_StartStop"></a>
Starting and Stopping Channel</h3>
<p>The function for an application to start a selected data channel and associate itself with it is <a class="el" href="le__dcs__interface_8h.html#a5bc8d9cf7b8e79645ab89845d8c3b05a">le_dcs_Start()</a>, while the opposite to stop and disassociate with it is <a class="el" href="le__dcs__interface_8h.html#abb80712dce43754bdb70e76faf788d61">le_dcs_Stop()</a>.</p>
<p>Example of starting and stoping a channel: </p><pre class="fragment"><div class="line">  <span class="keywordtype">void</span> ClientStartChannel</div><div class="line">  (</div><div class="line">      le_dcs_ChannelRef_t channelRef,</div><div class="line">      le_dcs_ReqObjRef_t *reqObj</div><div class="line">  )</div><div class="line">  {</div><div class="line"><span class="keywordflow">if</span> ((channelRef == 0) || !reqObj)</div><div class="line">      {</div><div class="line">          <a class="code" href="le__log_8h.html#a353590f91b3143a7ba3a416ae5a50c3d">LE_ERROR</a>(<span class="stringliteral">"Invalid inputs for starting channel with reference %p"</span>, channelRef);</div><div class="line">          <span class="keywordflow">return</span>;</div><div class="line">      }</div><div class="line">      *reqObj = <a class="code" href="le__dcs__interface_8h.html#a5bc8d9cf7b8e79645ab89845d8c3b05a">le_dcs_Start</a>(channelRef);</div><div class="line">      <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Started channel with reference %p and request reference %p"</span>, channelRef, *reqObj);</div><div class="line">  }</div><div class="line"> </div><div class="line">  <span class="keywordtype">void</span> ClientStopChannel</div><div class="line">  (</div><div class="line">      le_dcs_ReqObjRef_t reqObj</div><div class="line">  )</div><div class="line">  {</div><div class="line">      <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> ret;</div><div class="line">      <span class="keywordflow">if</span> (!reqObj)</div><div class="line">      {</div><div class="line">          <a class="code" href="le__log_8h.html#a353590f91b3143a7ba3a416ae5a50c3d">LE_ERROR</a>(<span class="stringliteral">"Invalid input for stopping channel with request reference %p"</span>, reqObj);</div><div class="line">          <span class="keywordflow">return</span>;</div><div class="line">      }</div><div class="line"> </div><div class="line">      ret = <a class="code" href="le__dcs__interface_8h.html#abb80712dce43754bdb70e76faf788d61">le_dcs_Stop</a>(reqObj);</div><div class="line">      <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Stopped channel with request reference %p, release status %d"</span>, reqObj, ret);</div><div class="line">  }</div></pre><!-- fragment --><h1><a class="anchor" id="le_dcs_ConnectionFailure"></a>
Handling of Connection Failures</h1>
<p>With the <code>le_dcs</code> interface, connection failures over a channel are handled within the channel itself. Connection retries over another channel of the same or different technology will not be internally attempted like with the <code>le_data</code> interface.</p>
<p>If the channel fails the default behavior is for DCS to try to reconnect over the same channel. If a different channel is wanted to be tried as a backup that logic and direction needs to be added to the application logic. If there is an issue with a channel, the application associated with the channel needs to disassociate from it and re-associate with another channel.</p>
<p>Technology-specific conditions and custom-made handlings in <code>le_dcs</code> are now implemented and attempted within the technology itself, i.e. the default behavior for cellular channels will have a different behavior than WiFi's.</p>
<p>Best practices are to retry a reconnect over a certain limited duration with a back-off duration. After all allowed attempts have exhausted with no success, then DCS will send a channel down event notification to the interested applications and stop the retries. In situations involving a system-wide blackout, one example is in the cellular packet switched state's becoming false, a retry won't be attempted until its recovery, i.e. in the example the cellular packet switched state's going back to true, where DCS will resume retrying to reconnect back all the channels of the corresponding technology that are administratively up.</p>
<p>It is very necessary to note that for some technologies after a channel has failed and then reconnected back, the network interface and IP address assigned to its use might have changed (depending on settings like DHCP). The default gateway and DNS addresses for this channel might have changed as well and applications must take this into account and might need to re-adjust the routes and/or gateway address settings after a channel state flapped.</p>
<p class="copyright">Copyright (C) Sierra Wireless Inc. </p>
</div></div>
<br clear="left"/>
</div>
</div>
<link href="resources/css/jqtree.css" rel="stylesheet" type="text/css"/>
<script src="resources/js/tree.jquery.js" type="text/javascript"></script>
<script src="resources/js/jquery.cookie.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<link href="resources/css/perfect-scrollbar.min.css" rel="stylesheet"/>
<script src="resources/js/perfect-scrollbar.jquery.min.js"></script>
</body>
</html>
