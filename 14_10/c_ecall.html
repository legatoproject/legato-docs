<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Legato: eCall</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <img alt="Logo" src="legatoLogo.png"/>
    <div id="projectbrief">Simplifying M2M development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('c_ecall.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">eCall </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="le__ecall__interface_8h.html">API Reference</a></p>
<hr/>
<p> eCall is a technology initiative intended to bring rapid assistance to auto accidents anywhere in the European Union. When a serious vehicle accident occurs, sensors automatically trigger an eCall. When activated, the in-vehicle system (IVS) establishes a 112-voice connection.</p>
<p>The Mobile Network Operator handles the eCall like any other 112 call and routes the call to the most appropriate emergency response centre - Public Safety Answering Point (PSAP).</p>
<p>At the same time, a digital "minimum set of data" (MSD) message is sent over the voice call using in-band modem signals. The MSD includes accident information like time, location, driving direction, and vehicle description.</p>
<p>The eCall can also be activated manually. The mobile network operator identifies that the 112 call is an eCall from the “eCall flag” inserted by the vehicle’s communication module.</p>
<dl class="section note"><dt>Note</dt><dd>eCall service is only available on automotive products.</dd></dl>
<h1><a class="anchor" id="le_ecall_session"></a>
eCall Session</h1>
<p>Start an eCall session by creating an eCall object that calls <code><a class="el" href="le__ecall__interface_8h.html#a70b992c3a20ca7511d0d9e6f1ffceebd">le_ecall_Create()</a></code>. Stop an eCall session with <code><a class="el" href="le__ecall__interface_8h.html#a13afc62c93d1f17fe418e0fd3fc48e67">le_ecall_End()</a></code>.</p>
<p>The type of eCall and the kind of activation are specified using different functions to start the eCall session:</p>
<ul>
<li><code><a class="el" href="le__ecall__interface_8h.html#ae6ba5383e23b192f3d9fc18f9ce16b9a">le_ecall_StartManual()</a></code>: initiate a manual eCall session (triggered by a passenger, can be aborted by the passengers)</li>
<li><code><a class="el" href="le__ecall__interface_8h.html#a53db04dbfbfef979fe39258fe9590948">le_ecall_StartAutomatic()</a></code>: initiate an automatic eCall session (automatically triggered by the IVS in case of accident, cannot be interrupted by the passengers)</li>
<li><code><a class="el" href="le__ecall__interface_8h.html#a3384144824dafe7859cc601263903ed9">le_ecall_StartTest()</a></code>: initiate a test eCall session (to test the communication between the IVS and the PSAP)</li>
</ul>
<p>When the eCall object is no longer needed, call <code><a class="el" href="le__ecall__interface_8h.html#a431cc846cbded25ef3190b640acaadf3">le_ecall_Delete()</a></code> to free all allocated resources associated with the object.</p>
<p>The current state of an eCall session can be queried using <code><a class="el" href="le__ecall__interface_8h.html#aa44d0a365e520d554eee6c01de528a5d">le_ecall_GetState()</a></code>. Alternatively, an application can register a handler be notified when the session state changes. The handler can be managed using <code><a class="el" href="le__ecall__interface_8h.html#a453b64579f2884f1d26981bca38a201c">le_ecall_AddStateChangeHandler()</a></code> and <code><a class="el" href="le__ecall__interface_8h.html#a6be1fd10666da25882a2c6f78c82664d">le_ecall_RemoveStateChangeHandler()</a></code>.</p>
<h1><a class="anchor" id="le_ecall_msd"></a>
Minimum Set of Data (MSD)</h1>
<p>The dynamic values of the MSD can be set with:</p>
<ul>
<li><code><a class="el" href="le__ecall__interface_8h.html#ae1fa825e2f0271115e1dee8bc0b8cc92">le_ecall_SetMsdPosition()</a></code> sets the position of the vehicle.</li>
<li><code><a class="el" href="le__ecall__interface_8h.html#a06bab97aba545a35e8e9a205fe38af80">le_ecall_SetMsdPassengersCount()</a></code> sets the number of passengers.</li>
</ul>
<p>The static values are retrieved from the configuration tree.</p>
<p>It's possible to import a prepared MSD using the <code><a class="el" href="le__ecall__interface_8h.html#a6b1de45779bcba1a77ec07699b85fe00">le_ecall_ImportMsd()</a></code> function. The prepared MSD must answer the requirements described in the "EN 15722:2013" publication (this publication has been prepared by Technical Committee CEN/TC 278 “Intelligent Transport Systems").</p>
<dl class="section note"><dt>Note</dt><dd>The MSD transmission is performed automatically after the emergency call is established with the PSAP.</dd></dl>
<h1><a class="anchor" id="le_ecall_concurrency"></a>
Concurrency</h1>
<p>If another application tries to use the eCall service while a session is already in progress, the <code><a class="el" href="le__ecall__interface_8h.html#ae6ba5383e23b192f3d9fc18f9ce16b9a">le_ecall_StartManual()</a></code>, <code><a class="el" href="le__ecall__interface_8h.html#a53db04dbfbfef979fe39258fe9590948">le_ecall_StartAutomatic()</a></code>, <code><a class="el" href="le__ecall__interface_8h.html#a3384144824dafe7859cc601263903ed9">le_ecall_StartTest()</a></code> and <code><a class="el" href="le__ecall__interface_8h.html#a13afc62c93d1f17fe418e0fd3fc48e67">le_ecall_End()</a></code> functions will return a LE_DUPLICATE error. The eCall session in progress won't be interrupted or disturbed. The application can follow the session progress with 'state' functions like <code><a class="el" href="le__ecall__interface_8h.html#aa44d0a365e520d554eee6c01de528a5d">le_ecall_GetState()</a></code> and <code><a class="el" href="le__ecall__interface_8h.html#a453b64579f2884f1d26981bca38a201c">le_ecall_AddStateChangeHandler()</a></code>. A manual eCall can't interrupt an automatic eCall, and an automatic eCall can't interrupt a manual eCall.</p>
<h1><a class="anchor" id="le_ecall_samples"></a>
Code sample</h1>
<p>The following code sample shows how an eCall session is used:</p>
<div class="fragment"><div class="line"><a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> TriggerAutomaticEcall</div>
<div class="line">(</div>
<div class="line">    uint32_t    paxCount,</div>
<div class="line">    int32_t     latitude,</div>
<div class="line">    int32_t     longitude,</div>
<div class="line">    int32_t     direction</div>
<div class="line">)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Create the eCall Session</span></div>
<div class="line">    <a class="code" href="le__ecall__interface_8h.html#a27e7351b668016f3644702022a842c81">le_ecall_ObjRef_t</a> eCallRef = <a class="code" href="le__ecall__interface_8h.html#a70b992c3a20ca7511d0d9e6f1ffceebd">le_ecall_Create</a>();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Set the dynamic MSD values, the static values are retrieved from the config tree</span></div>
<div class="line">    <a class="code" href="le__ecall__interface_8h.html#ae1fa825e2f0271115e1dee8bc0b8cc92">le_ecall_SetMsdPosition</a>(eCallRef,</div>
<div class="line">                            <span class="keyword">true</span>,</div>
<div class="line">                            latitude,</div>
<div class="line">                            longitude,</div>
<div class="line">                            direction);</div>
<div class="line">    <a class="code" href="le__ecall__interface_8h.html#a06bab97aba545a35e8e9a205fe38af80">le_ecall_SetMsdPassengersCount</a>(eCallRef, paxCount);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Start the eCall session</span></div>
<div class="line">    <a class="code" href="le__ecall__interface_8h.html#a53db04dbfbfef979fe39258fe9590948">le_ecall_StartAutomatic</a>(eCallRef);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="le_ecall_configdb"></a>
Configuration tree</h1>
<p>The configuration database path for the eCall is: </p>
<pre class="fragment">/
    modemServices/
        eCall/
            psap&lt;string&gt; = &lt;PSAP number&gt;
            pushPull&lt;string&gt; = &lt;push-pull mode&gt;
            msdVersion&lt;int&gt; = &lt;MSD value&gt;
            maxRedialAttempts&lt;int&gt; = &lt;maximum redial attempts value&gt;
            vehicleType&lt;string&gt; = &lt;vehicle type&gt;
            vin&lt;string&gt; = &lt;VIN&gt;
            propulsionType/
                0&lt;string&gt; = &lt;propulsion type&gt;
                1&lt;string&gt; = &lt;propulsion type&gt;
                ...
</pre><p>The 'psap' field is the PSAP number.</p>
<p>The 'pushPull' field can be set with the following two choices (string type):</p>
<ul>
<li>"Push": the MSD is pushed by the IVS</li>
<li>"Pull": the MSD is sent when requested by the PSAP</li>
</ul>
<p>The 'msdVersion' field is the MSD format version.</p>
<p>The 'maxRedialAttempts' field is the time of that the IVS shall attempt to redial the call if the initial eCall attempt fails to connect, or the call is dropped for any reason other than by the PSAP operator clearing the call down or T2 (IVS Call Clear-down Fallback Timer) ends.</p>
<p>The 'vehicleType' field can be set with the following choices (string type):</p>
<ul>
<li>"Passenger-M1" (Passenger vehicle, Class M1)</li>
<li>"Bus-M2" (Buses and coaches, Class M2)</li>
<li>"Bus-M3" (Buses and coaches, Class M3)</li>
<li>"Commercial-N1" (Light commercial vehicles, Class N1)</li>
<li>"Heavy-N2" (Heavy duty vehicles, Class N2)</li>
<li>"Heavy-N3" (Heavy duty vehicles, Class N3)</li>
<li>"Motorcycle-L1e" (Motorcycles, Class L1e)</li>
<li>"Motorcycle-L2e" (Motorcycles, Class L2e)</li>
<li>"Motorcycle-L3e" (Motorcycles, Class L3e)</li>
<li>"Motorcycle-L4e" (Motorcycles, Class L4e)</li>
<li>"Motorcycle-L5e" (Motorcycles, Class L5e)</li>
<li>"Motorcycle-L6e" (Motorcycles, Class L6e)</li>
<li>"Motorcycle-L7e" (Motorcycles, Class L7e)</li>
</ul>
<p>The 'vin' is the vehicle identification number (string type).</p>
<p>The 'propulsionType' field can be set with the following choices (string type):</p>
<ul>
<li>"Gasoline" (Gasoline propulsion)</li>
<li>"Diesel" (Diesel propulsion)</li>
<li>"NaturalGas" (Compressed natural gas propulsion)</li>
<li>"Propane" (Liquid propane gas propulsion)</li>
<li>"Electric" (Electric propulsion)</li>
<li>"Hydrogen" (Hydrogen propulsion)</li>
<li>"Other" (Other type of propulsion)</li>
</ul>
<hr/>
<p>Copyright (C) Sierra Wireless, Inc. 2014. All rights reserved. Use of this work is subject to license. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="http://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless 2014
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.6
        </div>
    </div>
</body>
</html>
