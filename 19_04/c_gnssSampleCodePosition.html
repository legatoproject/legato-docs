<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html data-context="Build Apps" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Sample code for GNSS position information  - Legato Docs</title>
<meta content="legato™ is an open source Linux-based embedded platform designed to simplify connected IoT application development" name="description"/>
<meta content="legato, iot" name="keywords"/>
<meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<meta content="19.04.0" name="legato-version"/>
<link href="resources/images/legato.ico" rel="shortcut icon"/>
<link href="resources/images/legato.ico" rel="icon" type="image/x-icon"/>
<link href="resources/images/legato.ico" rel="shortcut icon" type="image/x-icon"/>
<link href="resources/images/legato.ico" rel="apple-touch-icon" type="image/x-icon"/>
<link href="resources/css/style.css" media="screen" rel="stylesheet" type="text/css"/>
<link href="resources/css/font-awesome.css" rel="stylesheet" type="text/css"/>
<!--[if IE]>
        <script src="resources/js/html5shiv.js"></script>
        <script src="resources/js/respond.js"></script>
        <![endif]-->
<script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
<script src="resources/js/main.js"></script>
<script src="tocs/Build_Apps_API_Guides.json"></script>
</head>
<body>
<noscript>
<input class="modal-closing-trick" id="modal-closing-trick" type="checkbox"/>
<div id="nojs">
<label for="modal-closing-trick">
<span>You seem to not have Javascript <a href="http://enable-javascript.com">enabled</a>, so site functionality like the search and navigation tree won't work.</span>
</label>
</div>
</noscript>
<div class="wrapper">
<div class="fa fa-bars documentation" id="menu-trigger"></div>
<div id="top">
<header>
<nav>
<a class="navlink" href="/">Introduction</a><a class="navlink selected" href="buildAppsMain.html">Build Apps</a><a class="navlink" href="buildPlatformMain.html">Build Platform</a><a class="navlink" href="aboutMain.html">About</a>
</nav>
</header>
</div>
<div class="white" id="menudocumentation">
<header>
<a href="/"> <img alt="Back to Legato Homepage" id="logo" src="resources/images/legato_logo.png"/></a>
<h2>/ Build Apps</h2>
<nav class="secondary">
<a href="getStarted.html">Get Started</a><a href="concepts.html">Concepts</a><a class="link-selected" href="apiGuidesMain.html">API Guides</a><a href="tools.html">Tools</a><a href="howToMain.html">How To</a><a href="experimentalMain.html">Experimental Features</a>
</nav>
<nav class="ui-front">
<i class="fa fa-search" id="search-icon"></i>
<input id="searchbox" placeholder="Search"/>
</nav>
</header>
</div>
<div id="resizable">
<div id="left">
<div id="tree1"></div>
</div>
</div>
<div class="content">
<div class="header">
<div class="headertitle">
<h1 class="title">Sample code for GNSS position information </h1> </div>
</div><div class="contents">
<div class="textblock"><pre class="fragment"><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Handler function for Position Notifications.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> PositionHandlerFunction</div><div class="line">(</div><div class="line">    le_gnss_SampleRef_t positionSampleRef,</div><div class="line">    <span class="keywordtype">void</span>* contextPtr</div><div class="line">)</div><div class="line">{</div><div class="line">    <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> result;</div><div class="line">    <span class="comment">// Date parameters</span></div><div class="line">    uint16_t year;</div><div class="line">    uint16_t month;</div><div class="line">    uint16_t day;</div><div class="line">    <span class="comment">// Time parameters</span></div><div class="line">    uint16_t hours;</div><div class="line">    uint16_t minutes;</div><div class="line">    uint16_t seconds;</div><div class="line">    uint16_t milliseconds;</div><div class="line">    <span class="comment">// GPS time</span></div><div class="line">    uint32_t gpsWeek;</div><div class="line">    uint32_t gpsTimeOfWeek;</div><div class="line">    <span class="comment">// Leap seconds in advance</span></div><div class="line">    uint8_t leapSeconds;</div><div class="line">    <span class="comment">// Position state</span></div><div class="line">    le_gnss_FixState_t state;</div><div class="line">    <span class="comment">// Location</span></div><div class="line">    int32_t     latitude;</div><div class="line">    int32_t     longitude;</div><div class="line">    int64_t     latitudeOnPZ90;</div><div class="line">    int64_t     longitudeOnPZ90;</div><div class="line">    int32_t     altitude;</div><div class="line">    int32_t     altitudeOnWgs84;</div><div class="line">    int64_t     altitudeOnPZ90;</div><div class="line">    int32_t     hAccuracy;</div><div class="line">    int32_t     vAccuracy;</div><div class="line">    int32_t     magneticDeviation;</div><div class="line">    <span class="comment">// DOP parameter</span></div><div class="line">    uint16_t dop;</div><div class="line">    <span class="comment">// Horizontal speed</span></div><div class="line">    uint32_t hSpeed;</div><div class="line">    uint32_t hSpeedAccuracy;</div><div class="line">    <span class="comment">// Vertical speed</span></div><div class="line">    int32_t vSpeed;</div><div class="line">    int32_t vSpeedAccuracy;</div><div class="line">    <span class="comment">// Direction</span></div><div class="line">    uint32_t direction;</div><div class="line">    uint32_t directionAccuracy;</div><div class="line">    le_gnss_DopType_t dopType = LE_GNSS_PDOP;</div><div class="line">    le_gnss_Resolution_t dataRes = LE_GNSS_RES_ZERO_DECIMAL;</div><div class="line"> </div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *tabDop[] =</div><div class="line">    {</div><div class="line">        <span class="stringliteral">"Position dilution of precision (PDOP)"</span>,</div><div class="line">        <span class="stringliteral">"Horizontal dilution of precision (HDOP)"</span>,</div><div class="line">        <span class="stringliteral">"Vertical dilution of precision (VDOP)"</span>,</div><div class="line">        <span class="stringliteral">"Geometric dilution of precision (GDOP)"</span>,</div><div class="line">        <span class="stringliteral">"Time dilution of precision (TDOP)"</span></div><div class="line">    };</div><div class="line"> </div><div class="line">    <span class="keywordflow">if</span> (NULL == positionSampleRef)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a353590f91b3143a7ba3a416ae5a50c3d">LE_ERROR</a>(<span class="stringliteral">"New Position sample is NULL!"</span>);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a2a91ea8857cf190fde71d85ba930a498">LE_DEBUG</a>(<span class="stringliteral">"New Position sample %p"</span>, positionSampleRef);</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="comment">// Get UTC date</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a29602d1e12325d0076802af0db7f23ca">le_gnss_GetDate</a>(positionSampleRef, &amp;year, &amp;month, &amp;day);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">    <span class="comment">// Get UTC time</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a0d014a96fc8b15b736d04747d51082d9">le_gnss_GetTime</a>(positionSampleRef, &amp;hours, &amp;minutes, &amp;seconds, &amp;milliseconds);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">    <span class="comment">// Get Epoch time</span></div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#a38c21e7f7f7da5481f67e118fb3ea89c">le_gnss_GetEpochTime</a>(positionSampleRef, &amp;EpochTime));</div><div class="line"> </div><div class="line">    <span class="comment">// Display time/date format 13:45:30 2009-06-15</span></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"%02d:%02d:%02d %d-%02d-%02d,"</span>, hours, minutes, seconds, year, month, day);</div><div class="line"> </div><div class="line">    <span class="comment">// Display Epoch time</span></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"epoch time: %llu:"</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) EpochTime);</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#ab058224c242c97d458fcc8ad03b1f1c9">le_gnss_InjectUtcTime</a>(EpochTime , 0));</div><div class="line"> </div><div class="line">    <span class="comment">// Get GPS time</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a4e9966df8185978aaef75399d5aff2d3">le_gnss_GetGpsTime</a>(positionSampleRef, &amp;gpsWeek, &amp;gpsTimeOfWeek);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"GPS time W %02d:ToW %dms"</span>, gpsWeek, gpsTimeOfWeek);</div><div class="line"> </div><div class="line">    <span class="comment">// Get time accuracy</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#ad41698ff4a68651b9fb81b862d4274f6">le_gnss_GetTimeAccuracy</a>(positionSampleRef, &amp;TimeAccuracy);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"GPS time acc %d"</span>, TimeAccuracy);</div><div class="line"> </div><div class="line">    <span class="comment">// Get UTC leap seconds in advance</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a9e2b23f2420e53ca86f48a0f0c43f2d0">le_gnss_GetGpsLeapSeconds</a>(positionSampleRef, &amp;leapSeconds);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"UTC leap seconds in advance %d"</span>, leapSeconds);</div><div class="line"> </div><div class="line">    <span class="comment">// Get position state</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a0a0df2ffe42b6277f43af0e52e617339">le_gnss_GetPositionState</a>(positionSampleRef, &amp;state);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result));</div><div class="line">    <a class="code" href="le__log_8h.html#a2a91ea8857cf190fde71d85ba930a498">LE_DEBUG</a>(<span class="stringliteral">"Position state: %s"</span>, (LE_GNSS_STATE_FIX_NO_POS == state)?<span class="stringliteral">"No Fix"</span></div><div class="line">                                 :(LE_GNSS_STATE_FIX_2D == state)?<span class="stringliteral">"2D Fix"</span></div><div class="line">                                 :(LE_GNSS_STATE_FIX_3D == state)?<span class="stringliteral">"3D Fix"</span></div><div class="line">                                 : <span class="stringliteral">"Unknown"</span>);</div><div class="line">    <span class="comment">// Get Location</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#ada100f53f9ad9f3df852fcc6639c15bc">le_gnss_GetLocation</a>(positionSampleRef, &amp;latitude, &amp;longitude, &amp;hAccuracy);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Position lat.%f, long.%f, hAccuracy.%f"</span>,</div><div class="line">                (<span class="keywordtype">float</span>)latitude/1000000.0,</div><div class="line">                (<span class="keywordtype">float</span>)longitude/1000000.0,</div><div class="line">                (<span class="keywordtype">float</span>)hAccuracy/100.0);</div><div class="line"> </div><div class="line">        <span class="comment">// Latitude conversion</span></div><div class="line">        result = <a class="code" href="le__gnss__interface_8h.html#af32fd94e35e4df94b65c84740c5dbf42">le_gnss_ConvertDataCoordinateSystem</a>(LE_GNSS_COORDINATE_SYSTEM_WGS84,</div><div class="line">                                                     LE_GNSS_COORDINATE_SYSTEM_PZ90,</div><div class="line">                                                     LE_GNSS_POS_LATITUDE,</div><div class="line">                                                     latitude,</div><div class="line">                                                     &amp;latitudeOnPZ90);</div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5377262702e8434207b03533259e0c5f">LE_UNSUPPORTED</a> == result));</div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Latitude: On WGS84 %d, On PZ90 %"</span> PRId64 <span class="stringliteral">", float %f"</span>,</div><div class="line">                    latitude,</div><div class="line">                    latitudeOnPZ90,</div><div class="line">                    (<span class="keywordtype">float</span>)latitudeOnPZ90/1000000.0);</div><div class="line">        }</div><div class="line"> </div><div class="line">        <span class="comment">// Longitude conversion</span></div><div class="line">        result = <a class="code" href="le__gnss__interface_8h.html#af32fd94e35e4df94b65c84740c5dbf42">le_gnss_ConvertDataCoordinateSystem</a>(LE_GNSS_COORDINATE_SYSTEM_WGS84,</div><div class="line">                                                     LE_GNSS_COORDINATE_SYSTEM_PZ90,</div><div class="line">                                                     LE_GNSS_POS_LONGITUDE,</div><div class="line">                                                     longitude,</div><div class="line">                                                     &amp;longitudeOnPZ90);</div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5377262702e8434207b03533259e0c5f">LE_UNSUPPORTED</a> == result));</div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Longitude: On WGS84 %d, On PZ90 %"</span> PRId64 <span class="stringliteral">", float %f"</span>,</div><div class="line">                    longitude,</div><div class="line">                    longitudeOnPZ90,</div><div class="line">                    (<span class="keywordtype">float</span>)longitudeOnPZ90/1000000.0);</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> (INT32_MAX != latitude)</div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Latitude %f"</span>, (<span class="keywordtype">float</span>)latitude/1000000.0);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Latitude unknown %d"</span>, latitude);</div><div class="line">        }</div><div class="line"> </div><div class="line">        <span class="keywordflow">if</span> (INT32_MAX != longitude)</div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Latitude %f"</span>, (<span class="keywordtype">float</span>)longitude/1000000.0);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Longitude unknown %d"</span>, longitude);</div><div class="line">        }</div><div class="line"> </div><div class="line">        <span class="keywordflow">if</span> (INT32_MAX != hAccuracy)</div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Horizontal accuracy %f"</span>, (<span class="keywordtype">float</span>)hAccuracy/100.0);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Horizontal accuracy unknown %d"</span>, hAccuracy);</div><div class="line">        }</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="comment">// Get altitude</span></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Test SetDataResolution() for vAccuracy parameter of le_gnss_GetAltitude() function"</span>);</div><div class="line"> </div><div class="line">    <span class="keywordflow">for</span> (dataRes=LE_GNSS_RES_ZERO_DECIMAL; dataRes&lt;LE_GNSS_RES_UNKNOWN; dataRes++)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#a4cfa7d0e69ad462f09af7d6a596cbea5">le_gnss_SetDataResolution</a>(LE_GNSS_DATA_VACCURACY, dataRes));</div><div class="line">        result = <a class="code" href="le__gnss__interface_8h.html#a5cc278268a4e75c5e2a5f8c1ffb64fa9">le_gnss_GetAltitude</a>( positionSampleRef, &amp;altitude, &amp;vAccuracy);</div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">switch</span>(dataRes)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_ZERO_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, altitude.%f, vAccuracy.%f"</span>,</div><div class="line">                            dataRes, (<span class="keywordtype">float</span>)altitude/1000.0, (<span class="keywordtype">float</span>)vAccuracy);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_ONE_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, altitude.%f, vAccuracy.%f"</span>,</div><div class="line">                            dataRes, (<span class="keywordtype">float</span>)altitude/1000.0, (<span class="keywordtype">float</span>)vAccuracy/10.0);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_TWO_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, altitude.%f, vAccuracy.%f"</span>,</div><div class="line">                            dataRes, (<span class="keywordtype">float</span>)altitude/1000.0, (<span class="keywordtype">float</span>)vAccuracy/100.0);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_THREE_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, altitude.%f, vAccuracy.%f"</span>,</div><div class="line">                            dataRes, (<span class="keywordtype">float</span>)altitude/1000.0, (<span class="keywordtype">float</span>)vAccuracy/1000.0);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">default</span>:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Unknown resolution."</span>);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Altitude unknown [%d,%d]"</span>, altitude, vAccuracy);</div><div class="line">        }</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="comment">// Get altitude in meters, between WGS-84 earth ellipsoid</span></div><div class="line">    <span class="comment">// and mean sea level [resolution 1e-3]</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a59727ef079dc93dfadef75dd6a021cd0">le_gnss_GetAltitudeOnWgs84</a>(positionSampleRef, &amp;altitudeOnWgs84);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"AltitudeOnWgs84: %f"</span>, (<span class="keywordtype">float</span>)altitudeOnWgs84/1000.0);</div><div class="line"> </div><div class="line">        result = <a class="code" href="le__gnss__interface_8h.html#af32fd94e35e4df94b65c84740c5dbf42">le_gnss_ConvertDataCoordinateSystem</a>(LE_GNSS_COORDINATE_SYSTEM_WGS84,</div><div class="line">                                                     LE_GNSS_COORDINATE_SYSTEM_PZ90,</div><div class="line">                                                     LE_GNSS_POS_ALTITUDE,</div><div class="line">                                                     altitudeOnWgs84,</div><div class="line">                                                     &amp;altitudeOnPZ90);</div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5377262702e8434207b03533259e0c5f">LE_UNSUPPORTED</a> == result));</div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Altitude: On WGS84: %d, On PZ90 %"</span> PRId64 <span class="stringliteral">", float %f"</span>,</div><div class="line">                    altitudeOnWgs84,</div><div class="line">                    altitudeOnPZ90,</div><div class="line">                    (<span class="keywordtype">float</span>)altitudeOnPZ90/1000.0);</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"AltitudeOnWgs84 unknown [%d]"</span>, altitudeOnWgs84);</div><div class="line">    }</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Dop parameters: \n"</span>);</div><div class="line"> </div><div class="line">    <span class="comment">// Set the DOP resolution</span></div><div class="line">    <span class="keywordflow">if</span> (LE_GNSS_RES_UNKNOWN == ++DopRes)</div><div class="line">    {</div><div class="line">        DopRes = LE_GNSS_RES_ZERO_DECIMAL;</div><div class="line">    }</div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#ae7345052efc38f199989aafcd27224e2">le_gnss_SetDopResolution</a>(DopRes));</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Set DOP resolution: %d decimal place\n"</span>, DopRes);</div><div class="line"> </div><div class="line">    <span class="keywordflow">do</span></div><div class="line">    {</div><div class="line">        <span class="comment">// Get DOP parameter</span></div><div class="line">        result = <a class="code" href="le__gnss__interface_8h.html#a87cbadea6fe7ebd8ef74d45bdeef1416">le_gnss_GetDilutionOfPrecision</a>(positionSampleRef, dopType, &amp;dop);</div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((result == <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a>) || (result == <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a>));</div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">switch</span>(DopRes)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_ZERO_DECIMAL:</div><div class="line">                     <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"resolution: %d decimal place, %s %.1f\n"</span>,</div><div class="line">                            DopRes, tabDop[dopType], (<span class="keywordtype">float</span>)dop);</div><div class="line">                     <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_ONE_DECIMAL:</div><div class="line">                     <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"resolution: %d decimal place, %s %.1f\n"</span>,</div><div class="line">                            DopRes, tabDop[dopType], (<span class="keywordtype">float</span>)(dop)/10);</div><div class="line">                     <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_TWO_DECIMAL:</div><div class="line">                     <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"resolution: %d decimal place, %s %.2f\n"</span>,</div><div class="line">                            DopRes, tabDop[dopType], (<span class="keywordtype">float</span>)(dop)/100);</div><div class="line">                     <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_THREE_DECIMAL:</div><div class="line">                <span class="keywordflow">default</span>:</div><div class="line">                     <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"resolution: %d decimal place, %s %.3f\n"</span>,</div><div class="line">                            DopRes, tabDop[dopType], (<span class="keywordtype">float</span>)(dop)/1000);</div><div class="line">                     <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"%s invalid %d\n"</span>, tabDop[dopType], dop);</div><div class="line">        }</div><div class="line">        dopType++;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">while</span> (dopType != LE_GNSS_DOP_LAST);</div><div class="line"> </div><div class="line">    <span class="comment">// Get horizontal speed</span></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Test SetDataResolution() for hSpeedAccuracy parameter of le_gnss_GetHorizontalSpeed() \</span></div><div class="line"><span class="stringliteral">            function"</span>);</div><div class="line"> </div><div class="line">    <span class="keywordflow">for</span> (dataRes=LE_GNSS_RES_ZERO_DECIMAL; dataRes&lt;LE_GNSS_RES_UNKNOWN; dataRes++)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#a4cfa7d0e69ad462f09af7d6a596cbea5">le_gnss_SetDataResolution</a>(LE_GNSS_DATA_HSPEEDACCURACY, dataRes));</div><div class="line">        result = <a class="code" href="le__gnss__interface_8h.html#a483fba8fc6b0fa116bcbd889af95fc4f">le_gnss_GetHorizontalSpeed</a>( positionSampleRef, &amp;hSpeed, &amp;hSpeedAccuracy);</div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">switch</span>(dataRes)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_ZERO_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, hSpeed %u - Accuracy %.3f"</span>,</div><div class="line">                            dataRes, hSpeed/100, (<span class="keywordtype">float</span>)hSpeedAccuracy);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_ONE_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, hSpeed %u - Accuracy %.3f"</span>,</div><div class="line">                            dataRes, hSpeed/100, (<span class="keywordtype">float</span>)hSpeedAccuracy/10);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_TWO_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, hSpeed %u - Accuracy %.3f"</span>,</div><div class="line">                            dataRes, hSpeed/100, (<span class="keywordtype">float</span>)hSpeedAccuracy/100);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_THREE_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, hSpeed %u - Accuracy %.3f"</span>,</div><div class="line">                            dataRes, hSpeed/100, (<span class="keywordtype">float</span>)hSpeedAccuracy/1000);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">default</span>:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Unknown resolution."</span>);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"hSpeed unknown [%u,%.3f]"</span>, hSpeed, (<span class="keywordtype">float</span>)hSpeedAccuracy);</div><div class="line">        }</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="comment">// Get vertical speed</span></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Test SetDataResolution() for vSpeedAccuracy parameter of le_gnss_GetVerticalSpeed() \</span></div><div class="line"><span class="stringliteral">            function"</span>);</div><div class="line"> </div><div class="line">    <span class="keywordflow">for</span> (dataRes=LE_GNSS_RES_ZERO_DECIMAL; dataRes&lt;LE_GNSS_RES_UNKNOWN; dataRes++)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#a4cfa7d0e69ad462f09af7d6a596cbea5">le_gnss_SetDataResolution</a>(LE_GNSS_DATA_VSPEEDACCURACY, dataRes));</div><div class="line">        result = <a class="code" href="le__gnss__interface_8h.html#a37a370cec19610be1f99d9c9db291a1e">le_gnss_GetVerticalSpeed</a>( positionSampleRef, &amp;vSpeed, &amp;vSpeedAccuracy);</div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">        {</div><div class="line">            <span class="keywordflow">switch</span>(dataRes)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_ZERO_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, vSpeed %d - Accuracy %.3f"</span>,</div><div class="line">                            dataRes, vSpeed/100, (<span class="keywordtype">float</span>)vSpeedAccuracy);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_ONE_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, vSpeed %d - Accuracy %.3f"</span>,</div><div class="line">                            dataRes, vSpeed/100, (<span class="keywordtype">float</span>)vSpeedAccuracy/10);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_TWO_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, vSpeed %d - Accuracy %.3f"</span>,</div><div class="line">                            dataRes, vSpeed/100, (<span class="keywordtype">float</span>)vSpeedAccuracy/100);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">case</span> LE_GNSS_RES_THREE_DECIMAL:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Resolution: %d decimal place, vSpeed %d - Accuracy %.3f"</span>,</div><div class="line">                            dataRes, vSpeed/100, (<span class="keywordtype">float</span>)vSpeedAccuracy/1000);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">                <span class="keywordflow">default</span>:</div><div class="line">                    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Unknown resolution."</span>);</div><div class="line">                    <span class="keywordflow">break</span>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"vSpeed unknown [%d,%.3f]"</span>, vSpeed, (<span class="keywordtype">float</span>)vSpeedAccuracy);</div><div class="line">        }</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="comment">// Get direction</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#aabc2432ec207a1e6cb74d444407aad11">le_gnss_GetDirection</a>( positionSampleRef, &amp;direction, &amp;directionAccuracy);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"direction %u - Accuracy %u"</span>, direction/10, directionAccuracy/10);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"direction unknown [%u,%u]"</span>, direction, directionAccuracy);</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="comment">// Get the magnetic deviation</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a0f47ace8d52f0a525a6abfccc24a11ec">le_gnss_GetMagneticDeviation</a>( positionSampleRef, &amp;magneticDeviation);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"magnetic deviation %d"</span>, magneticDeviation/10);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"magnetic deviation unknown [%d]"</span>,magneticDeviation);</div><div class="line">    }</div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">/* Satellites status */</span></div><div class="line">    uint8_t satsInViewCount;</div><div class="line">    uint8_t satsTrackingCount;</div><div class="line">    uint8_t satsUsedCount;</div><div class="line">    result =  <a class="code" href="le__gnss__interface_8h.html#a5ae945ad1921b621e9631e4286f40784">le_gnss_GetSatellitesStatus</a>(positionSampleRef,</div><div class="line">                                          &amp;satsInViewCount,</div><div class="line">                                          &amp;satsTrackingCount,</div><div class="line">                                          &amp;satsUsedCount);</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"satsInView %d - satsTracking %d - satsUsed %d"</span>,</div><div class="line">            satsInViewCount,</div><div class="line">            satsTrackingCount,</div><div class="line">            satsUsedCount);</div><div class="line"> </div><div class="line">    <span class="comment">/* Satellites information */</span></div><div class="line">    uint16_t satIdPtr[LE_GNSS_SV_INFO_MAX_LEN];</div><div class="line">    <span class="keywordtype">size_t</span> satIdNumElements = <a class="code" href="le__basics_8h.html#a8d8f28a045f43b477cafb67a99894c07">NUM_ARRAY_MEMBERS</a>(satIdPtr);</div><div class="line">    le_gnss_Constellation_t satConstPtr[LE_GNSS_SV_INFO_MAX_LEN];</div><div class="line">    <span class="keywordtype">size_t</span> satConstNumElements = <a class="code" href="le__basics_8h.html#a8d8f28a045f43b477cafb67a99894c07">NUM_ARRAY_MEMBERS</a>(satConstPtr);</div><div class="line">    <span class="keywordtype">bool</span> satUsedPtr[LE_GNSS_SV_INFO_MAX_LEN];</div><div class="line">    <span class="keywordtype">size_t</span> satUsedNumElements = <a class="code" href="le__basics_8h.html#a8d8f28a045f43b477cafb67a99894c07">NUM_ARRAY_MEMBERS</a>(satUsedPtr);</div><div class="line">    uint8_t satSnrPtr[LE_GNSS_SV_INFO_MAX_LEN];</div><div class="line">    <span class="keywordtype">size_t</span> satSnrNumElements = <a class="code" href="le__basics_8h.html#a8d8f28a045f43b477cafb67a99894c07">NUM_ARRAY_MEMBERS</a>(satSnrPtr);</div><div class="line">    uint16_t satAzimPtr[LE_GNSS_SV_INFO_MAX_LEN];</div><div class="line">    <span class="keywordtype">size_t</span> satAzimNumElements = <a class="code" href="le__basics_8h.html#a8d8f28a045f43b477cafb67a99894c07">NUM_ARRAY_MEMBERS</a>(satAzimPtr);</div><div class="line">    uint8_t satElevPtr[LE_GNSS_SV_INFO_MAX_LEN];</div><div class="line">    <span class="keywordtype">size_t</span> satElevNumElements = <a class="code" href="le__basics_8h.html#a8d8f28a045f43b477cafb67a99894c07">NUM_ARRAY_MEMBERS</a>(satElevPtr);</div><div class="line">    <span class="keywordtype">int</span> i;</div><div class="line"> </div><div class="line">    result =  <a class="code" href="le__gnss__interface_8h.html#a08654437579b3e033ba1c54c860febab">le_gnss_GetSatellitesInfo</a>(positionSampleRef,</div><div class="line">                                        satIdPtr,</div><div class="line">                                        &amp;satIdNumElements,</div><div class="line">                                        satConstPtr,</div><div class="line">                                        &amp;satConstNumElements,</div><div class="line">                                        satUsedPtr,</div><div class="line">                                        &amp;satUsedNumElements,</div><div class="line">                                        satSnrPtr,</div><div class="line">                                        &amp;satSnrNumElements,</div><div class="line">                                        satAzimPtr,</div><div class="line">                                        &amp;satAzimNumElements,</div><div class="line">                                        satElevPtr,</div><div class="line">                                        &amp;satElevNumElements);</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line"> </div><div class="line">    <span class="comment">// Satellite Vehicle information</span></div><div class="line">    <span class="keywordflow">for</span> (i=0; i&lt;satIdNumElements; i++)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> ((0 != satIdPtr[i]) &amp;&amp; (UINT16_MAX != satIdPtr[i]))</div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"[%02d] SVid %03d - C%01d - U%d - SNR%02d - Azim%03d - Elev%02d"</span>,</div><div class="line">                    i,</div><div class="line">                    satIdPtr[i],</div><div class="line">                    satConstPtr[i],</div><div class="line">                    satUsedPtr[i],</div><div class="line">                    satSnrPtr[i],</div><div class="line">                    satAzimPtr[i],</div><div class="line">                    satElevPtr[i]);</div><div class="line"> </div><div class="line">            <span class="keywordflow">if</span> (LE_GNSS_SV_CONSTELLATION_SBAS == satConstPtr[i])</div><div class="line">            {</div><div class="line">                <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"SBAS category : %d"</span>, <a class="code" href="le__gnss__interface_8h.html#a4ea5971e6495429ab28c41207cba37d7">le_gnss_GetSbasConstellationCategory</a>(satIdPtr[i]));</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="comment">// Release provided Position sample reference</span></div><div class="line">    <a class="code" href="le__gnss__interface_8h.html#a89cdf0fb25e8204befc65db7aa6837db">le_gnss_ReleaseSampleRef</a>(positionSampleRef);</div><div class="line">}</div><div class="line"> </div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Test: Add Position Handler</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span>* PositionThread</div><div class="line">(</div><div class="line">    <span class="keywordtype">void</span>* context</div><div class="line">)</div><div class="line">{</div><div class="line"> </div><div class="line">    <a class="code" href="le__gnss__interface_8h.html#a3b352251c2764092c56f20592f5894ca">le_gnss_ConnectService</a>();</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"======== Position Handler thread  ========"</span>);</div><div class="line">    PositionHandlerRef = <a class="code" href="le__gnss__interface_8h.html#ac300457f532757caf79d60b6dba60d67">le_gnss_AddPositionHandler</a>(PositionHandlerFunction, NULL);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((PositionHandlerRef != NULL));</div><div class="line"> </div><div class="line">    <a class="code" href="le__eventLoop_8h.html#ae313b457994371c658be9fe0494a01ff">le_event_RunLoop</a>();</div><div class="line">    <span class="keywordflow">return</span> NULL;</div><div class="line">}</div><div class="line"> </div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Test: GNSS position handler</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> TestLeGnssPositionHandler</div><div class="line">(</div><div class="line">    <span class="keywordtype">void</span></div><div class="line">)</div><div class="line">{</div><div class="line">    <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> result;</div><div class="line">    <a class="code" href="le__thread_8h.html#a32121104c6b4ca39008eb79a4d6862f2">le_thread_Ref_t</a> positionThreadRef;</div><div class="line">    le_gnss_SampleRef_t positionSampleRef;</div><div class="line">    uint64_t epochTime;</div><div class="line">    uint32_t ttff = 0;</div><div class="line">    uint8_t  minElevation;</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Start Test Testle_gnss_PositionHandlerTest"</span>);</div><div class="line"> </div><div class="line">    <span class="comment">// NMEA frame GPGSA is checked that no SV with elevation below 10</span></div><div class="line">    <span class="comment">// degrees are given.</span></div><div class="line">    minElevation = 10;</div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a78982eb8669530eef1bbc79ff79347e4">le_gnss_SetMinElevation</a>(minElevation);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86caef8ecf11fa8556fd2d3ca8faab697717">LE_OUT_OF_RANGE</a> == result));</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Set minElevation %d"</span>,minElevation);</div><div class="line">    }</div><div class="line"> </div><div class="line">    <span class="comment">// Test le_gnss_SetDataResolution() before starting GNSS</span></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Sanity test for le_gnss_SetDataResolution"</span>);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86cabe505065132f6e8850da6f476d8fb783">LE_BAD_PARAMETER</a> == <a class="code" href="le__gnss__interface_8h.html#a4cfa7d0e69ad462f09af7d6a596cbea5">le_gnss_SetDataResolution</a>(LE_GNSS_DATA_UNKNOWN,</div><div class="line">                                                            LE_GNSS_RES_ONE_DECIMAL));</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Start GNSS"</span>);</div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#add90639835a531c4b9d15554e4f3ba16">le_gnss_Start</a>());</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Wait 5 seconds"</span>);</div><div class="line">    sleep(5);</div><div class="line"> </div><div class="line">    <span class="comment">// Test le_gnss_SetDataResolution() after starting GNSS</span></div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86cabe505065132f6e8850da6f476d8fb783">LE_BAD_PARAMETER</a> == <a class="code" href="le__gnss__interface_8h.html#a4cfa7d0e69ad462f09af7d6a596cbea5">le_gnss_SetDataResolution</a>(LE_GNSS_DATA_VACCURACY,</div><div class="line">                                                            LE_GNSS_RES_UNKNOWN));</div><div class="line"> </div><div class="line">    <span class="comment">// Add Position Handler Test</span></div><div class="line">    positionThreadRef = <a class="code" href="le__thread_8h.html#a87e02a46f92e9e3e11ed28a2b265872f">le_thread_Create</a>(<span class="stringliteral">"PositionThread"</span>,PositionThread,NULL);</div><div class="line">    <a class="code" href="le__thread_8h.html#a38df3877ee5ab9fac17b2fc0be46c27e">le_thread_Start</a>(positionThreadRef);</div><div class="line"> </div><div class="line">    <span class="comment">// test Cold Restart boosted by le_gnss_InjectUtcTime</span></div><div class="line">    <span class="comment">// EpochTime and timeAccuracy should be valid and saved by now</span></div><div class="line">    sleep(2);</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Ask for a Cold restart"</span>);</div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#aa702703bbeebbefd65dd51b1f9fd4ce5">le_gnss_ForceColdRestart</a>());</div><div class="line"> </div><div class="line">    <span class="comment">// Last accurate epochTime and timeAccuracy are used</span></div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(0 != EpochTime);</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"TimeAccuracy %d EpochTime %llu"</span>,TimeAccuracy, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>)EpochTime);</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#ab058224c242c97d458fcc8ad03b1f1c9">le_gnss_InjectUtcTime</a>(EpochTime , TimeAccuracy));</div><div class="line">    <span class="comment">// Get TTFF,position fix should be still in progress for the FACTORY start</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a6b2fbb3902c9fd3336b5940b2abacb12">le_gnss_GetTtff</a>(&amp;ttff);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca92b0367090993d8b41d1560663d01e8d">LE_BUSY</a> == result);</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"TTFF is checked as not available immediatly after a Cold restart"</span>);</div><div class="line"> </div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86cabe505065132f6e8850da6f476d8fb783">LE_BAD_PARAMETER</a> == <a class="code" href="le__gnss__interface_8h.html#ae7345052efc38f199989aafcd27224e2">le_gnss_SetDopResolution</a>(LE_GNSS_RES_UNKNOWN));</div><div class="line"> </div><div class="line">    <span class="comment">// first test in ConvertDop() in le_gnss.c to find the default resolution.</span></div><div class="line">    <span class="comment">// Test that the chosen resolution in PositionHandlerFunction is LE_GNSS_RES_THREE_DECIMAL</span></div><div class="line"> </div><div class="line">    <span class="comment">// Wait for a 3D fix</span></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Wait 60 seconds for a 3D fix"</span>);</div><div class="line">    sleep(60);</div><div class="line">    <span class="comment">// Get TTFF</span></div><div class="line">    result = <a class="code" href="le__gnss__interface_8h.html#a6b2fbb3902c9fd3336b5940b2abacb12">le_gnss_GetTtff</a>(&amp;ttff);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>((<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a> == result) || (<a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca92b0367090993d8b41d1560663d01e8d">LE_BUSY</a> == result));</div><div class="line">    <span class="keywordflow">if</span>(result == <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422">LE_OK</a>)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"TTFF cold restart = %d msec"</span>, ttff);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"TTFF cold restart not available"</span>);</div><div class="line">    }</div><div class="line"> </div><div class="line">    <a class="code" href="le__gnss__interface_8h.html#a3c257c3c2d2f8d54402a91f685924fd5">le_gnss_RemovePositionHandler</a>(PositionHandlerRef);</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Wait 5 seconds"</span>);</div><div class="line">    sleep(5);</div><div class="line"> </div><div class="line">    <span class="comment">// stop thread</span></div><div class="line">    <a class="code" href="le__thread_8h.html#a885420d1114a934de49e1b508189ca8d">le_thread_Cancel</a>(positionThreadRef);</div><div class="line">    <span class="comment">// Get Epoch time, get last position sample</span></div><div class="line">    positionSampleRef = <a class="code" href="le__gnss__interface_8h.html#a07ee55596c930fe47981ba0a4d018bd2">le_gnss_GetLastSampleRef</a>();</div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#a38c21e7f7f7da5481f67e118fb3ea89c">le_gnss_GetEpochTime</a>(positionSampleRef, &amp;epochTime));</div><div class="line"> </div><div class="line">    <span class="comment">// Display epoch time</span></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"epoch time: %llu:"</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) epochTime);</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">"Stop GNSS"</span>);</div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__gnss__interface_8h.html#a93d63fdc76dbced071956b87de2abff7">le_gnss_Stop</a>());</div><div class="line">    EpochTime=0;</div><div class="line">    TimeAccuracy=0;</div><div class="line">}</div><div class="line"> </div></pre><!-- fragment --></div></div>
<br clear="left"/>
</div>
</div>
<link href="resources/css/jqtree.css" rel="stylesheet" type="text/css"/>
<script src="resources/js/tree.jquery.js" type="text/javascript"></script>
<script src="resources/js/jquery.cookie.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<link href="resources/css/perfect-scrollbar.min.css" rel="stylesheet"/>
<script src="resources/js/perfect-scrollbar.jquery.min.js"></script>
</body>
</html>
